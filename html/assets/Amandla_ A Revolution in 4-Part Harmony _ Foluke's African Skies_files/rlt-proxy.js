(function(){var e;var t;var n;var o=[];var i=[];var r=false;var a="jetpack:wpcomRLT";function c(e){if(!Array.isArray(n)){return false}return n.includes(e)}function s(e,t,n){if(t&&typeof t.postMessage==="function"){try{t.postMessage(JSON.stringify({type:"rltMessage",data:{event:"invalidate",token:e,sourceOrigin:window.location.origin}}),n)}catch(e){return}}}window.rltInvalidateToken=function(n,i){if(n===e){e=null}try{if(window.location===window.parent.location&&window.localStorage){if(window.localStorage.getItem(a)===n){window.localStorage.removeItem(a)}}}catch(e){console.info("localstorage access for invalidate denied - probably blocked third-party access",window.location.href)}for(const[e,t]of o){if(e!==i){s(n,t,e)}}if(t&&t!==i&&window.parent){s(n,window.parent,t)}};window.rltInjectToken=function(e,t,n){if(t&&typeof t.postMessage==="function"){try{t.postMessage(JSON.stringify({type:"loginMessage",data:{event:"login",success:true,type:"rlt",token:e,sourceOrigin:window.location.origin}}),n)}catch(e){return}}};window.rltIsAuthenticated=function(){return!!e};window.rltGetToken=function(){return e};window.rltAddInitializationListener=function(t){if(r){t(e)}else{i.push(t)}};window.rltStoreToken=function(t){e=t;try{if(window.location===window.parent.location&&window.localStorage){window.localStorage.setItem(a,t)}}catch(e){console.info("localstorage access denied - probably blocked third-party access",window.location.href)}};window.rltInitialize=function(s){if(!s||typeof window.postMessage!=="function"){return}e=s.token;n=s.iframeOrigins;t=s.parentOrigin;try{if(!e&&window.location===window.parent.location&&window.localStorage){e=window.localStorage.getItem(a)}}catch(e){console.info("localstorage access denied - probably blocked third-party access",window.location.href)}window.addEventListener("message",function(n){var i=n&&n.data;if(typeof i==="string"){try{i=JSON.parse(i)}catch(e){return}}var r=i&&i.type;var a=i&&i.data;if(r==="loginMessage"){if(a&&a.type==="rlt"&&a.token!==e){rltStoreToken(a.token);for(const[t,n]of o){rltInjectToken(e,n,t)}if(t&&t!==a.sourceOrigin&&window.parent){rltInjectToken(e,window.parent,t)}}}if(r==="rltMessage"){if(a&&a.event==="invalidate"&&a.token===e){rltInvalidateToken(a.token)}if(a&&a.event==="register"){if(c(n.origin)){o.push([n.origin,n.source]);if(e){rltInjectToken(e,n.source,n.origin)}}}}});i.forEach(function(t){t(e)});i=[];window.parent.postMessage({type:"rltMessage",data:{event:"register"}},"*");r=true}})();